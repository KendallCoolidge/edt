<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta>
<meta name="DC.Type" content="topic"></meta>
<meta name="DC.Title" content="Invoking a service asynchronously from a Rich UI application"></meta>
<meta name="abstract" content="In Rich UI, you invoke a service asynchronously by declaring a binding variable and then accessing a call statement version that is described in the current topic."></meta>
<meta name="description" content="In Rich UI, you invoke a service asynchronously by declaring a binding variable and then accessing a call statement version that is described in the current topic."></meta>
<meta name="DC.subject" content="Rich UI, services, invoking asynchronously, Rich UI, asynchronous invocation"></meta>
<meta name="keywords" content="Rich UI, services, invoking asynchronously, Rich UI, asynchronous invocation"></meta>
<meta name="DC.Relation" scheme="URI" content="../topics/tedt01002.html"></meta>
<meta name="copyright" content="(C) Copyright 2011" type="primary"></meta>
<meta name="DC.Rights.Owner" content="(C) Copyright 2011" type="primary"></meta>
<meta name="DC.Format" content="XHTML"></meta>
<meta name="DC.Identifier" content="tedt01023"></meta>
<meta name="DC.Language" content="en-us"></meta>
<link rel="stylesheet" type="text/css" href="../../PRODUCT_PLUGIN/style/commonltr.css"></link>
<title>Invoking a service asynchronously from a Rich UI application</title>
</head>
<body id="tedt01023"><a name="tedt01023"><!-- --></a>


<h1 class="topictitle1">Invoking a service asynchronously from a Rich UI application</h1>



<div><p>In Rich UI, you invoke a service asynchronously by declaring
a binding variable and then accessing a <span class="synph"><span class="kwd">call</span></span> statement
version that is described in the current topic.</p>

<p>For background detail, see <a href="cedt01030.html" title="One of the more elegant aspects of EGL is its use of resource bindings, each of which is a value that describes how to access a service or database. In most cases, you maintain bindings in an EGL deployment descriptor, which is external to your logic. The deployment descriptor provides the access details when you are developing or deploying your application.">Resource bindings</a>.</p>

<p>Here is the asynchronous version of the <strong>call</strong> statement:</p>

<pre class="codeblock">call 	<var class="varname">InterfaceTypeName</var>.<var class="varname">operationName</var>(<var class="varname">argumentList</var>)
   using <var class="varname">bindingVariable</var>
   returning to <var class="varname">myCallbackFunction</var>
   onException <var class="varname">myExceptionHandler</var>;</pre>

<dl>
<dt class="dlterm"><span class="synph"><span class="var">InterfaceTypeName</span></span> </dt>

<dd>The name of an Interface type or, for dedicated services, of a
Service or Interface type.</dd>


<dt class="dlterm"><span class="synph"><span class="var">operationName</span></span> </dt>

<dd>The name of the operation; either the name of a function in a
Service type or the name of a function prototype in an Interface type.</dd>


<dt class="dlterm"><span class="synph"><span class="var">argumentList</span></span> </dt>

<dd>A list of arguments, one separated from the next by a comma <p>For
restrictions on arguments, see “Restrictions in the prototypes used
for service access.”</p>
</dd>


<dt class="dlterm"><span class="synph"><span class="var">bindingVariable</span></span> </dt>

<dd>A variable that holds the access detail:<ul>
<li>When you access a REST or REST-RPC service, the variable type
is HTTPRest. <div class="p">In this case, the primary way to declare the variable
is to include a Resource annotation that refers to an EGL deployment
descriptor entry:<pre class="codeblock">myBindingVar HttpRest {@Resource {uri = """"""""binding:myEntry""""""""}};</pre>
</div>
</li>

<li>When you access a dedicated service, the variable type is HTTPProxy,
and no deployment descriptor is involved:<pre class="codeblock">myBindingVar HttpProxy;</pre>
<div class="p">Here
is code that declares a binding-variable value in the <strong>call</strong> statement
itself: <pre class="codeblock">call MyInterface.myOperation() using new HttpProxy
                               returning to myCallBackFunction
                               onException myExceptionHandler;</pre>
</div>
</li>

</ul>
</dd>


<dt class="dlterm"><span class="synph"><span class="var">myCallbackFunction</span></span> </dt>

<dd>The name of a callback function or delegate that is available
to the call statement. In most cases, the function or delegate is
in the same Rich UI handler or in a library. The callback function
is described later in this topic.</dd>


<dt class="dlterm"><span class="synph"><span class="var">myExceptionHandler</span></span> </dt>

<dd>The name of an exception handler or a delegate that is available
to the <span class="synph"><span class="kwd">call</span></span> statement.  In most cases, the
exception handler or delegate is in the same Rich UI handler or in
a library. The exception handler is described later in this topic. </dd>



</dl>

<div class="section"><h2 class="sectiontitle">Keystroke assistance for the call statement</h2><div class="p">In
the workbench, the following kinds of keystroke assistance are available:<ul>
<li>After you type the <span class="synph"><span class="kwd">returning to</span></span> or <span class="synph"><span class="kwd">onException</span></span> keyword
in the <span class="synph"><span class="kwd">call</span></span> statement, you can request content
assist by pressing Ctrl+Space. A list of functions is displayed, and
you can select one. </li>

<li>If you type the <span class="synph"><span class="kwd">call</span></span> statement with
the ending semicolon and include a reference to a callback or an onException
function that does not exist, you can request that the workbench create
the missing logic. The keystroke is Ctrl+1.</li>

</ul>
</div>
</div>

<div class="section"><h2 class="sectiontitle">Callback function</h2><p>The <span class="synph"><span class="kwd">callback</span></span> function
receives the values, if any, that are in the response sent by the
service. The callback itself has no return value.</p>
<p> If the <span class="synph"><span class="kwd">callback</span></span> function
is invoked from a third-party REST service, the function can have
zero or one parameter. If a parameter is specified, its type must
match the type of the return value that is specified in the Interface
part, and the parameter modifier is IN. </p>
<div class="p">If the <span class="synph"><span class="kwd">callback</span></span> function
is invoked from a SOAP service or from an EGL REST-RPC service, the
relationship of the function parameters and the service-invocation
parameters is best described by an example: <ul>
<li>Consider the following function prototype in an Interface part:<pre class="codeblock">Interface EmployeeService {}
   Function GetEmployeeDetail(employeeCode STRING IN, 
                              employeeSalary FLOAT OUT, 
                              employeeStatus STRING INOUT) 
            returns(myEmployeeRecordPart);
end
</pre>
</li>

<li>This example shows a binding-variable declaration and <span class="synph"><span class="kwd">call</span></span> statement
used to invoke the service:<pre class="codeblock">myBindingVar HttpRest{@Resource{uri=""""""""binding:myEntry""""""""}};
call MyInterface.GetEmployeeDetail(""""""""A123"""""""", 25.8, """"""""Full-time"""""""")
   using myBindingVar
   returning to myCallback 
   onException myExceptionHandler;
</pre>
</li>

<li>Here is the outline of a <span class="synph"><span class="kwd">callback</span></span> function: <pre class="codeblock">Function myCallBack(salary FLOAT IN, 
                    status STRING IN, 
                    myRecord myEmployeeRecordPart IN)
    // statements here
end</pre>
<p>The function includes one parameter for each service-operation
parameter that is OUT or INOUT. The order of those parameters in the
callback function is the same as the order in the service operation.
The service-operation return value is represented as the last parameter
in the callback function.</p>
</li>

</ul>
</div>
<div class="p">In general, the rules for designing the <span class="synph"><span class="kwd">callback</span></span> function
for a web SOAP service or an EGL REST-RPC service are as follows: <ul>
<li>The function has a series of parameters that are in the same order
as the OUT and INOUT parameters in the service invocation.</li>

<li>If the service invocation has a return value, the <span class="synph"><span class="kwd">callback</span></span> function
includes an additional parameter to accept the return value.</li>

<li>The <span class="synph"><span class="kwd">callback</span></span> function can include an
optional final parameter that provides access to the HTTP request
and response data. The parameter is of type <span class="synph"><span class="kwd">IHTTP</span></span>,
as described in the language reference topic named “eglx.http package.”</li>

<li>Each parameter in the function has the IN modifier.</li>

</ul>
</div>
</div>

<div class="section"><h2 class="sectiontitle">onException function</h2><div class="p">The <span class="synph"><span class="kwd">onException</span></span> function
has the following characteristics:<ul>
<li>No return value</li>

<li>The function accepts an Exception record of type <span class="synph"><span class="kwd">AnyException</span></span>,
and you can test that record to determine the specific type received</li>

</ul>
</div>
<p>Here is the outline of an <span class="synph"><span class="kwd">onException</span></span> function:</p>
<pre class="codeblock">Function myExceptionHandler(exp AnyException)
   case 
      when (exp isa ServiceBindingException)
         ;
      when (exp isa ServiceInvocationException)
         ;
      otherwise
         ; 
   end
end</pre>
<div class="p">Errors might occur in the following places:<ul>
<li>In a service binding; that is, in how the service access is specified
in your code. This error might involve a problem in the deployment
descriptor.</li>

<li>In the communication of the Rich UI application with the EGL Rich
UI Proxy</li>

<li>In the EGL Rich UI Proxy</li>

<li>In the communication of the EGL Rich UI Proxy with the service</li>

<li>In the service</li>

</ul>
</div>
<p>A problem in a service binding results in a <span class="synph"><span class="kwd">ServiceBindingException</span></span>.
Other problems result in a <span class="synph"><span class="kwd">ServiceInvocationException</span></span> or
a <span class="synph"><span class="kwd">RuntimeException</span></span>, which is less likely.</p>
</div>

<div class="section"><h2 class="sectiontitle">For more examples</h2><div class="p">For more examples, see
the following topics:<ul>
<li><a href="tedt01010.html" title="When you write and deploy a Rich UI application, you can access an EGL service that is deployed on the application server, along with the Rich UI handlers. One benefit is that you don't need to configure the service-location detail when you write or deploy the application.">Accessing a dedicated service</a></li>

<li><a href="tedt01025.html" title="In EGL, you can use the following Interface part to access a third-party REST service:">Using a provided Interface part for a 3rd-party REST service</a></li>

</ul>
</div>
</div>

</div>

<div>
<div class="familylinks">
</div>
</div>

</body>
</html>